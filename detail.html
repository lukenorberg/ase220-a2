<!doctype html>
<html lang="en">
  <head>
    <title>Detail</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="styles.css" type="text/css" />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
      crossorigin="anonymous"
    ></script>
  </head>

  <body>
    <div class="container">
      <div class="row">
        <div class="colpic">
          <img
            class="pic"
            src=""
            alt="Pet photo"
            id="photo"
          /><!-- JS below fills in src attribute based on pet id-->
        </div>
        <div class="col">
          <h5><a href="index.html">Back to Index</a></h5>
          <h3 id="name"></h3>
          <div class="centerText">
            <p id="breed"></p>
            <p id="sex"></p>
            <p id="age"></p>
            <p id="color"></p>
            <p id="fixed"></p>
            <p id="id"></p>
            <p id="microchip_num"></p>
            <p id="summary"></p>
          </div>

          <h3>Health Information</h3>
          <div class="centerContent">
            <ul id="health_info">
              <li id="info_1"></li>
              <li id="info_2"></li>
              <li id="info_3"></li>
              <li id="info_4"></li>
            </ul>
          </div>
        </div>
      </div>
    <script
      src="https://code.jquery.com/jquery-3.7.1.js"
      integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4="
      crossorigin="anonymous"
    ></script>
    <script>
      $(function() {
        function getIndex(id, arr) {
          for (let i = 0; i < arr.length; i++) {
            if (arr[i].id == id) {
              return i;
            }
          }
          return -1;
        }

        const queryString = window.location.search;
        const urlParams = new URLSearchParams(queryString);
        let apiUrl = "https://jsonblob.com/api/jsonBlob/1210772481471537152";

        $.get(apiUrl, function(data) {
          let pets = data;
          let petId = parseInt(urlParams.getAll("item")[0]);
          let index = getIndex(petId, pets);

          $("#photo").attr("src", "images/pets/" + pets[index].id + ".jpg");
          $("#name").text(pets[index].name);
          $("#breed").html("<strong>Breed: </strong>" + pets[index].breed);
          $("#sex").html("<strong>Sex: </strong>" + pets[index].sex);
          $("#age").html("<strong>Age: </strong>" + pets[index].age);
          $("#color").html("<strong>Color: </strong>" + pets[index].color);
          $("#fixed").html("<strong>Spayed/Neutered: </strong>" + pets[index].fixed);
          $("#id").html("<strong>Animal ID: </strong>" + pets[index].id);
          $("#microchip_num").html("<strong>Microchip Number: </strong>" + pets[index].microchip_num);
          $("#summary").html("<strong>Summary: </strong>" + pets[index].summary);

          //filling in the text information on the page
          let healthInfo = pets[index].health_info;
          for (let j = 0; j < healthInfo.length; j++) {
            $(`#info_${j + 1}`).html(healthInfo[j]);
          }
        });
      });
    </script>
  </body>
</html>
